<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Polished Configuration</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }
        .pass { color: green; }
        .fail { color: red; }
    </style>
</head>
<body>
    <h1>Testing Polished Product Line Configuration</h1>
    
    <div class="test-section">
        <h2>API Data Test</h2>
        <div id="api-test">Loading...</div>
    </div>
    
    <div class="test-section">
        <h2>Service Layer Test</h2>
        <div id="service-test">Loading...</div>
    </div>

    <script type="module">
        // Test API direct access
        async function testAPI() {
            try {
                const response = await fetch('https://pim.dude.digital/items/product_lines?filter[sku_code][_eq]=MIRR&fields=*,default_options.*');
                const data = await response.json();
                const polished = data.data[0];
                
                if (polished && polished.default_options && polished.default_options.length > 0) {
                    document.getElementById('api-test').innerHTML = `
                        <span class="pass">✅ PASS</span> - Polished product line has ${polished.default_options.length} default_options
                        <br>Collections: ${[...new Set(polished.default_options.map(opt => opt.collection))].join(', ')}
                    `;
                } else {
                    document.getElementById('api-test').innerHTML = `<span class="fail">❌ FAIL</span> - No default_options found`;
                }
            } catch (error) {
                document.getElementById('api-test').innerHTML = `<span class="fail">❌ ERROR</span> - ${error.message}`;
            }
        }

        // Test service layer by importing and calling function
        async function testServiceLayer() {
            try {
                // Import the service function
                const { getProductLineWithOptions } = await import('./src/services/directus.js');
                
                // Test with Polished product line
                const polished = await getProductLineWithOptions({ id: 23, name: 'Polished', sku_code: 'MIRR', active: true });
                
                if (polished && polished.default_options && polished.default_options.length > 0) {
                    document.getElementById('service-test').innerHTML = `
                        <span class="pass">✅ PASS</span> - Service layer returns ${polished.default_options.length} default_options for Polished
                        <br>Collections: ${[...new Set(polished.default_options.map(opt => opt.collection))].join(', ')}
                    `;
                } else {
                    document.getElementById('service-test').innerHTML = `<span class="fail">❌ FAIL</span> - Service layer returns no default_options`;
                }
            } catch (error) {
                document.getElementById('service-test').innerHTML = `<span class="fail">❌ ERROR</span> - ${error.message}`;
            }
        }

        // Run tests
        testAPI();
        testServiceLayer();
    </script>
</body>
</html>